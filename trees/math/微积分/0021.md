
---
title: 实二次不可约
taxon: example
---

$\gdef\d{\operatorname{d}}$
$\gdef\spaces#1{~ #1 ~}$

分解 $R(x) = \frac{2x+1}{(x^2+x+1)(x+1)}$ 从而计算 $\int R(x) \d x$. 

$$
\frac{2x+1}{(x^2+x+1)(x+1)} \spaces= \frac{A}{x+1} + \frac{Bx+C}{x^2+x+1}
$$

现在确定 $A,B,C$. 注意 $R(0) = A+C=1$. $R(1) = \frac{A}2 + \frac{B+C}3 = \frac{1}{2}$ 即 $3A + 2B + 2C = 3$. $(x+1)R(x)|_{x+1 \to 0} = A = -1$. 解得 $(A,B,C) = (-1,1,2)$. 如此就有 

$$ \int R(x) \d x \spaces= -\int \frac{1}{x+1} \d x + \int \frac{x+2}{x^2+x+1} \d x $$

这里的 $\int \frac{x+2}{x^2+x+1} \d x$ 不太明显, 我们先拆出一个对数部分 $\frac{\d y}{y} = \frac{2x+1}{x^2+x+1}$, 从而将其写成

$$
\begin{aligned}
\int \frac{x+2}{x^2+x+1} \d x 
&\spaces= \frac{1}{2} \int \frac{2x+1}{x^2+x+1} \d x + \frac{3}{2} \int \frac{1}{x^2+x+1} \d x \\
&\spaces= \frac{1}{2} \log(x^2+x+1) + \frac{3}{2} \int \frac{1}{(x+\frac{1}{2})^2 + \frac{3}{4}} \d x \\
&\spaces= \frac{1}{2} \log(x^2+x+1) + \sqrt{3}\tan^{-1} \frac{2x+1}{\sqrt{x}}
\end{aligned}
$$

这里 $\log$ 内没有加绝对值是因为 $(x+\frac{1}{2})^2 + \frac{3}{4} \gt 0$. 综合得到

$$ \square \spaces= -\log|x+1| + \frac{1}{2} \log(x^2+x+1) + \sqrt{3}\tan^{-1} \frac{2x+1}{\sqrt{x}} $$

对数部分看不出也无妨, 请回忆一般的 [配凑形式](./0022.md). 
